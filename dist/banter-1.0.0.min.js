/*! BanterJS by Adam Timberlake created on 2013-08-18 */
!function(a,b){a.banterApp=angular.module("banterApp",[]),banterApp.factory("$logger",["$rootScope",function(){var a={};return a.log=function(a){console.log("Banter.js @ "+moment().format("HH:mm:ss")+" - "+a)},a.error=function(a){console.error("Banter.js @ "+moment().format("HH:mm:ss")+" - "+a)},a}]),banterApp.factory("$webSocket",["$rootScope","$logger",function(a,c){var d={};return a.webSocket={},d.connect=function(d){var e;a.webSocket=e=new WebSocket(d),e.onopen=function(){c.log("Banter.js Connected, Sugar!"),e.send("Server: Client Connected at "+moment().format("HH:mm:ss")),a.$broadcast("connected")},e.onerror=function(){c.error("Client Threw an Error, Petal!")},e.onmessage=function(d){if("undefined"==typeof b)return console.error("Please install jQuery to continue using Banter.js."),!1;var e=b.parseJSON(d.data);return e.command?(c.log("Command Received ("+e.length+" Characters), Honey..."),a.$broadcast("receivedCommand",e),void 0):(c.log("Message Received ("+e.length+" Characters), Sweetie..."),a.$broadcast("receivedMessage",e),void 0)}},a.$on("sendMessage",function(b,d){var e=JSON.stringify(d);c.log("Message Sent ("+e.length+" Characters), Cherry..."),a.webSocket.send(e)}),d}]),banterApp.controller("ApplicationController",["$scope","$webSocket","$logger",function(a,b,c){a.connected=!1,a.messages=[],a.message="",a.$on("bootstrap",function(a,d){c.log("Client Connecting: "+d),b.connect("ws://localhost:8080")}),a.$on("connected",function(){}),a.$on("receivedMessage",function(b,c){return a.messages.push(c),a.$apply(),!0}),a.$on("receivedCommand",function(b,c){c.connected&&(a.connected=!0,a.$apply())}),a.sendMessage=function(b){a.$emit("sendMessage",{name:"Wildhoney",message:b})}}]),banterApp.directive("banter",["$rootScope",function(a){return{restrict:"C",link:function(b){var c="undefined"!=typeof b.websocketServer?b.websocketServer:"ws://localhost:8080";a.$broadcast("bootstrap",c)}}}])}(window,jQuery);